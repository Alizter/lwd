<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lwd_seq (lwd.Lwd_seq)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">lwd</a> &#x00BB; Lwd_seq</nav><header class="odoc-preamble"><h1>Module <code><span>Lwd_seq</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#sequence-manipulation">Sequence manipulation</a><ul><li><a href="#primitive-constructors">Primitive constructors</a></li><li><a href="#looking-at-sequence-contents">Looking at sequence contents</a></li><li><a href="#conversion-between-sequences,-lists-and-arrays">Conversion between sequences, lists and arrays</a></li><li><a href="#balanced-variant-of-sequences">Balanced variant of sequences</a></li><li><a href="#transforming-sequences">Transforming sequences</a></li><li><a href="#low-level-interface-for-observing-changes">Low-level interface for observing changes</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="sequence-manipulation"><a href="#sequence-manipulation" class="anchor"></a>Sequence manipulation</h2><p><code>Lwd_seq</code> is an ordered collection with a pure interface. Changes to collections are easy to track.</p><p>A collection can be transformed with the usual map, filter and fold combinators. If the collection is updated, shared elements (in the sense of physical sharing), the result of the previous transformation will be reused for these elements.</p><p>The book-keeping overhead is O(n) in the number of changes, so O(1) per element.</p><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>!+'a t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-seq" class="anchored"><a href="#type-seq" class="anchor"></a><code><span><span class="keyword">type</span> <span>!+'a seq</span></span><span> = <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><p>The type of sequences</p><h3 id="primitive-constructors"><a href="#primitive-constructors" class="anchor"></a>Primitive constructors</h3><div class="odoc-spec"><div class="spec value" id="val-empty" class="anchored"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>A sequence with no element.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-element" class="anchored"><a href="#val-element" class="anchor"></a><code><span><span class="keyword">val</span> element : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>A singleton sequence. The physical identity of the element is considered when reusing previous computations.</p><p>If you do:</p><pre><code>let x1 = element x
let x2 = element x</code></pre><p>Then <code>x1</code> and <code>x2</code> are seen as different elements and no sharing will be done during transformation.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-concat" class="anchored"><a href="#val-concat" class="anchor"></a><code><span><span class="keyword">val</span> concat : <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>Concatenate two sequences into a bigger one. As for <code>element</code>, the physical identity of a sequence is considered for reuse.</p></div></div><h3 id="looking-at-sequence-contents"><a href="#looking-at-sequence-contents" class="anchor"></a>Looking at sequence contents</h3><div class="odoc-spec"><div class="spec type" id="type-view" class="anchored"><a href="#type-view" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'b) view</span></span><span> = </span></code><table><tr id="type-view.Empty" class="anchored"><td class="def variant constructor"><a href="#type-view.Empty" class="anchor"></a><code><span>| </span><span><span class="constructor">Empty</span></span></code></td></tr><tr id="type-view.Element" class="anchored"><td class="def variant constructor"><a href="#type-view.Element" class="anchor"></a><code><span>| </span><span><span class="constructor">Element</span> <span class="keyword">of</span> <span class="type-var">'a</span></span></code></td></tr><tr id="type-view.Concat" class="anchored"><td class="def variant constructor"><a href="#type-view.Concat" class="anchor"></a><code><span>| </span><span><span class="constructor">Concat</span> <span class="keyword">of</span> <span class="type-var">'b</span> * <span class="type-var">'b</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-view" class="anchored"><a href="#val-view" class="anchor"></a><code><span><span class="keyword">val</span> view : <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> )</span> <a href="#type-view">view</a></span></span></code></div><div class="spec-doc"><p>View how a sequence is defined</p></div></div><h3 id="conversion-between-sequences,-lists-and-arrays"><a href="#conversion-between-sequences,-lists-and-arrays" class="anchor"></a>Conversion between sequences, lists and arrays</h3><div class="odoc-spec"><div class="spec value" id="val-transform_list" class="anchored"><a href="#val-transform_list" class="anchor"></a><code><span><span class="keyword">val</span> transform_list : <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>Produce a sequence by transforming each element of a list and concatenating all results.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transform_array" class="anchored"><a href="#val-transform_array" class="anchor"></a><code><span><span class="keyword">val</span> transform_array : <span><span><span class="type-var">'a</span> array</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>Produce a sequence by transforming each element of an array and concatenating all results.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_list" class="anchored"><a href="#val-of_list" class="anchor"></a><code><span><span class="keyword">val</span> of_list : <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>Produce a sequence from a list</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_array" class="anchored"><a href="#val-of_array" class="anchor"></a><code><span><span class="keyword">val</span> of_array : <span><span><span class="type-var">'a</span> array</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span></span></code></div><div class="spec-doc"><p>Produce a sequence from an array</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_list" class="anchored"><a href="#val-to_list" class="anchor"></a><code><span><span class="keyword">val</span> to_list : <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p>Produce a list from a sequence</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_array" class="anchored"><a href="#val-to_array" class="anchor"></a><code><span><span class="keyword">val</span> to_array : <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> array</span></span></code></div><div class="spec-doc"><p>Produce an array from a sequence</p></div></div><h3 id="balanced-variant-of-sequences"><a href="#balanced-variant-of-sequences" class="anchor"></a>Balanced variant of sequences</h3><div class="odoc-spec"><div class="spec module" id="module-Balanced" class="anchored"><a href="#module-Balanced" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Balanced/index.html">Balanced</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A variant of the sequence type that guarantees that the depth of a transformation, measured as the number of nested <code>concat</code> nodes, grows in O(log n) where n is the number of elements in the sequnce.</p></div></div><h3 id="transforming-sequences"><a href="#transforming-sequences" class="anchor"></a>Transforming sequences</h3><p>All sequences live in <code>Lwd</code> monad: if a sequence changes slightly, parts that have not changed will not be re-transformed.</p><div class="odoc-spec"><div class="spec value" id="val-fold" class="anchored"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : 
  <span>map:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>reduce:<span>( <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> option</span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p><code>fold ~map ~reduce</code> transforms a sequence. If the sequence is non-empty, the <code>map</code> function is applied to element nodes and the <code>reduce</code> function is used to combine transformed concatenated nodes. If the sequence is empty, None is returned.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_monoid" class="anchored"><a href="#val-fold_monoid" class="anchor"></a><code><span><span class="keyword">val</span> fold_monoid : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../Lwd_utils/index.html#type-monoid">Lwd_utils.monoid</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p>Like <code>fold</code>, but reduction and default value are defined by a <code>monoid</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p><code>map f</code> transforms a sequence by applying <code>f</code> to each element.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-filter" class="anchored"><a href="#val-filter" class="anchor"></a><code><span><span class="keyword">val</span> filter : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p><code>filter p</code> transforms a sequence by keeping elements that satisfies <code>p</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-filter_map" class="anchored"><a href="#val-filter_map" class="anchor"></a><code><span><span class="keyword">val</span> filter_map : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> option</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p>Filter and map elements at the same time</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lift" class="anchored"><a href="#val-lift" class="anchor"></a><code><span><span class="keyword">val</span> lift : <span><span><span><span><span class="type-var">'a</span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p>Remove a layer of <code>Lwd</code> inside a sequence.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p>Sequence forms a monad too...</p></div></div><div class="odoc-spec"><div class="spec value" id="val-seq_bind" class="anchored"><a href="#val-seq_bind" class="anchor"></a><code><span><span class="keyword">val</span> seq_bind : <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div><div class="spec-doc"><p>Sequence forms a monad too...</p></div></div><div class="odoc-spec"><div class="spec value" id="val-monoid" class="anchored"><a href="#val-monoid" class="anchor"></a><code><span><span class="keyword">val</span> monoid : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../Lwd_utils/index.html#type-monoid">Lwd_utils.monoid</a></span></span></code></div><div class="spec-doc"><p>Monoid instance for sequences</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lwd_monoid" class="anchored"><a href="#val-lwd_monoid" class="anchor"></a><code><span><span class="keyword">val</span> lwd_monoid : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <a href="../Lwd_utils/index.html#type-monoid">Lwd_utils.monoid</a></span></span></code></div><div class="spec-doc"><p>Monoid instance for reactive sequences</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sort_uniq" class="anchored"><a href="#val-sort_uniq" class="anchor"></a><code><span><span class="keyword">val</span> sort_uniq : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-seq">seq</a></span> <a href="../Lwd/index.html#type-t">Lwd.t</a></span></span></code></div></div><h3 id="low-level-interface-for-observing-changes"><a href="#low-level-interface-for-observing-changes" class="anchor"></a>Low-level interface for observing changes</h3><div class="odoc-spec"><div class="spec module" id="module-Reducer" class="anchored"><a href="#module-Reducer" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Reducer/index.html">Reducer</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>